# Client Lifecycle

An Undici [Client](Client.md) can be best described as a state machine. A **Client** begins in the `idle` state with no socket connection and no requests in queue. At any point the **Client** can transition to a `closing` or `destroyed` state (more on these later). From the `idle` state, the **Client** can transition to the `processing` state. Upon entering this state, the **Client** will connect the internal socket to the origin url and then begin processing any requests in the queue. During the `processing` state, more requests may be queued for processing. Once the queue is empty, the internal socket will disconnect and the **Client** will transition back to the `idle` state. If more requests are queued, the **Client** will once again transition to the `processing` state. As stated previously, at any time the **Client** can be transitioned to the `closisng` or `destroyed` state. When the **Client** transitions to the `closing` state, it will gracefully process any existing requests in the queue before transitioning to the `destroyed` state. When the **Client** transitions to the `destroyed` state it immediately disconnects from an existing socket connection and sends an error to all existing requests.

[![](https://mermaid.ink/img/eyJjb2RlIjoic3RhdGVEaWFncmFtLXYyXG4gICAgWypdIC0tPiBpZGxlXG4gICAgcHJvY2Vzc2luZyAtLT4gY2xvc2luZyA6IGNsb3NlXG4gICAgaWRsZSAtLT4gY2xvc2luZyA6IGNsb3NlXG4gICAgaWRsZSAtLT4gZGVzdHJveWVkIDogZGVzdHJveVxuICAgIGlkbGUgLS0-IHByb2Nlc3NpbmcgOiBjb25uZWN0XG4gICAgcHJvY2Vzc2luZyAtLT4gaWRsZSA6IGRpc2Nvbm5lY3RcbiAgICBwcm9jZXNzaW5nIC0tPiBkZXN0cm95ZWQgOiBkZXN0cm95XG4gICAgY2xvc2luZyAtLT4gZGVzdHJveWVkIDogZGVzdHJveVxuICAgIGRlc3Ryb3llZCAtLT4gWypdIiwibWVybWFpZCI6eyJ0aGVtZSI6ImJhc2UifSwidXBkYXRlRWRpdG9yIjpmYWxzZX0)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoic3RhdGVEaWFncmFtLXYyXG4gICAgWypdIC0tPiBpZGxlXG4gICAgcHJvY2Vzc2luZyAtLT4gY2xvc2luZyA6IGNsb3NlXG4gICAgaWRsZSAtLT4gY2xvc2luZyA6IGNsb3NlXG4gICAgaWRsZSAtLT4gZGVzdHJveWVkIDogZGVzdHJveVxuICAgIGlkbGUgLS0-IHByb2Nlc3NpbmcgOiBjb25uZWN0XG4gICAgcHJvY2Vzc2luZyAtLT4gaWRsZSA6IGRpc2Nvbm5lY3RcbiAgICBwcm9jZXNzaW5nIC0tPiBkZXN0cm95ZWQgOiBkZXN0cm95XG4gICAgY2xvc2luZyAtLT4gZGVzdHJveWVkIDogZGVzdHJveVxuICAgIGRlc3Ryb3llZCAtLT4gWypdIiwibWVybWFpZCI6eyJ0aGVtZSI6ImJhc2UifSwidXBkYXRlRWRpdG9yIjpmYWxzZX0)
